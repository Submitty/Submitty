{% if new_token is defined and new_token_val is defined %}
    <div class="content" id="new-token-banner">
        <p>
            Your new VCS Authentication Token was created successfully and its value is displayed below.<br>
            <em>NOTE: Do not share this token with others. Treat it like a password.</em><br>
            <br>
        </p>
        <p>
            Save this value in a secure place -- <em>it will not be displayed if you reload this webpage</em>.<br>
            If you lose this value, you will need to create a new VCS Authentication Token.
        </p>
        <br>
        <p><b>Name</b>: {{ new_token.getName() }}</p>
        {% if new_token.getExpiration() is null %}
            <p><b>Expiration</b>: Never expires</p>
        {% else %}
            <p><b>Expiration</b>: {{ new_token.getExpiration()|date('m/d/Y @ h:i A T') }}</p>
        {% endif %}
        <p>
            <b>Value</b>: {{ new_token_val }}
            <i class="fas fa-copy" id="token-copy-button" title="Copy to clipboard" data-val="{{ new_token_val }}"></i>
        </p>
    </div>
{% endif %}

<div class="content">
    <h1>Authentication Tokens</h1>
        <p>
        For more information about managing and using these tokens, please see:<br>
        <a href="https://submitty.org/student/account/authentication_tokens">Submitty Authentication Tokens</a>
        <br><br>
        </p>
    <h2>Version Control System (GIT) Authentication Tokens</h2>
    <button class="btn btn-primary" id="new-auth-token-button">Create New VCS Authentication Token</button>
    <br><br>
    {% if tokens|length != 0 %}
    <table class="table mobile-table">
        <tr>
            <th>Name</th>
            <th>Expiration</th>
            <th>Action</th>
        </tr>
        {% for token in tokens %}
            <tr>
                <td>{{ token.getName() }}</td>
                {% if token.getExpiration() is null %}
                    <td>Never expires</td>
                {% else %}
                    {% if token.isExpired(current_time) %}
                        <td>EXPIRED on {{ token.getExpiration()|date('m/d/Y @ h:i A T') }}</td>
                    {% else %}
                        <td>{{ token.getExpiration()|date('m/d/Y @ h:i A T') }}</td>
                    {% endif %}
                {% endif %}
                <td>
                    <form action="/authentication_tokens/vcs/revoke" method="POST">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
                        <input type="hidden" name="id" value="{{ token.getId() }}">
                        <input type="submit" class="btn btn-danger" value="Revoke">
                    </form>
                </td>
            </tr>
        {% endfor %}
    </table>
    {% else %}
    <p>You don't have any Authentication Tokens.</p>
    {% endif %}
</div>

{% include('CreateVcsAuthTokenForm.twig') %}
