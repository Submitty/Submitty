---
# Assumes that local user accounts for instructor already exist.

- name: Add instructors to the course groups.
  ansible.builtin.user:
    name: "{{ username }}"
    groups: "{{ submitty_course_add_instructor_groups }}"
    append: yes
  loop:
    - "{{ course }}"
    - "{{ course }}_tas_www"
    - "{{ course }}_archive"
  loop_control:
    loop_var: submitty_course_add_instructor_groups

- name: Give course management permissions to "{{ username }}".
  ansible.builtin.user:
    name: "{{ submitty_course_add_instructor_users }}"
    groups: "submitty_course_builders"
    append: yes
  loop:
    - "{{ username }}"
  loop_control:
    loop_var: submitty_course_add_instructor_users
  notify: Reload fpm


- name: Call add_user role
  ansible.builtin.include_role:
    name: submitty_course_add_user
  # vars:
  #   username: "{{ username }}"
  #   firstname: "{{ firstname }}"
  #   lastname: "{{ lastname }}"
  #   email: "{{ email }}"
  #   password: "{{ password }}"
  #   semester: "{{ semester }}"
  #   course: "{{ course }}"
  #   user_group: "{{ user_group }}"

